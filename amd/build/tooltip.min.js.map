{"version":3,"file":"tooltip.min.js","sources":["../src/tooltip.js"],"sourcesContent":["// This file is part of local_checkmarkreport for Moodle - http://moodle.org/\n//\n// It is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// It is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handles overlays/tooltips in report tables!\n *\n * @author    Philipp Hager\n * @copyright 2014 Academic Moodle Cooperation {@link http://www.academic-moodle-cooperation.org}\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module local_checkmarkreport/tooltips\n */\ndefine(['core/popper', 'core/log'], function(Popper, log) {\n\n    /**\n     * Find the tooltip referred to by this element and show it.\n     *\n     * @param {Event} e\n     */\n    function _showTooltip(e) {\n        if (e.target.getAttribute('data-toggle') !== 'tooltip') {\n            var triggerEl = e.target.closest('[data-toggle=tooltip]');\n        } else {\n            var triggerEl = e.target;\n        }\n        var tooltipid = 'tooltip_' + triggerEl.getAttribute('id');\n        var tooltipEl = document.getElementById(tooltipid);\n\n        if (tooltipEl === null) {\n            var tooltipEl = document.createElement('div');\n            tooltipEl.id = tooltipid;\n            tooltipEl.classList.add('popover');\n            tooltipEl.classList.add('bs-popover-auto');\n            tooltipEl.setAttribute('role', 'tooltip');\n            triggerEl.setAttribute('aria-describedby', tooltipEl.id);\n            tooltipEl.innerHTML = '<div class=\"arrow\"></div><h3 class=\"popover-header\"></h3>' +\n                    '<div class=\"popover-body\">' + triggerEl.getAttribute('data-content') + '</div>';\n            tooltipEl.style.opacity = '0';\n            tooltipEl.setAttribute('aria-hidden', 'true');\n            document.body.appendChild(tooltipEl);\n        } else {\n            tooltipEl.style.display = 'block';\n        }\n\n        new Popper(triggerEl, tooltipEl, {\n            modifiers: {\n                placement: 'right'/*,\n                flip: {\n                    behavior: 'clockwise'\n                }*/\n            }\n        });\n         tooltipEl.style.opacity = '1';\n         tooltipEl.setAttribute('aria-hidden', 'false');\n    }\n\n    var _hide = function(toolTipEl) {\n        return function() {\n            toolTipEl.style.display = 'none';\n            toolTipEl.setAttribute('aria-hidden', 'true');\n        };\n    };\n\n    /**\n     * Find the tooltip referred to by this element and hide it.\n     *\n     * @param {Event} e\n     */\n    function _hideTooltip(e) {\n        if (e.target.getAttribute('data-toggle') !== 'tooltip') {\n            var tooltipId = 'tooltip_' + e.target.closest('[data-toggle=tooltip]').getAttribute('id');\n        } else {\n            var tooltipId = 'tooltip_' + e.target.id;\n        }\n        var toolTipEl = document.getElementById(tooltipId);\n\n        if (toolTipEl === null) {\n            log.info('Tooltip element not found!', 'local_checkmarkreport');\n        } else {\n            toolTipEl.style.opacity = '0';\n            window.setTimeout(_hide(toolTipEl), 200);\n        }\n    }\n\n    /**\n     * Listener for focus events.\n     * @param {FocusEvent} e\n     */\n    function _handleFocus(e) {\n        _showTooltip(e);\n    }\n\n    /**\n     * Listener for keydown events.\n     * @param {KeyboardEvent} e\n     */\n    function _handleKeyDown(e) {\n        if (e.key === 'Escape') {\n            _hideTooltip(e);\n        }\n    }\n\n    /**\n     * Listener for mouseover events.\n     * @param {MouseEvent} e\n     */\n    function _handleMouseOver(e) {\n        _showTooltip(e);\n    }\n\n    /**\n     * Listener for mouseout events.\n     * @param {MouseEvent} e\n     */\n    function _handleMouseOut(e) {\n        // The mouseout-event's relatedTarget is the element which has been entered!\n        if (e.relatedTarget !== undefined && e.relatedTarget !== null && e.relatedTarget.classList.contains('content')) {\n            return;\n        }\n\n        _hideTooltip(e);\n    }\n\n    /**\n     * Listener for blur events.\n     * @param {FocusEvent} e\n     */\n    function _handleBlur(e) {\n        _hideTooltip(e);\n    }\n\n    return {\n        /**\n         * Initialises the JavaScript for the checkmark report\n         */\n        initializer: function() {\n            log.info('Register tooltips!', 'local_checkmarkreport');\n\n            var tts = document.querySelectorAll('#checkmarkreporttable [data-toggle=\"tooltip\"]');\n            for (var i = 0; i < tts.length; i++) {\n                tts[i].addEventListener('focus', _handleFocus.bind(this));\n                tts[i].addEventListener('click', _handleFocus.bind(this));\n                tts[i].addEventListener('mouseover', _handleMouseOver.bind(this));\n                tts[i].addEventListener('mouseout', _handleMouseOut.bind(this));\n                tts[i].addEventListener('blur', _handleBlur.bind(this));\n                tts[i].addEventListener('keydown', _handleKeyDown.bind(this));\n            }\n        }\n    };\n});\n"],"names":["define","Popper","log","_showTooltip","e","target","getAttribute","triggerEl","closest","tooltipEl","tooltipid","document","getElementById","createElement","id","classList","add","setAttribute","innerHTML","style","opacity","body","appendChild","display","modifiers","placement","_hideTooltip","tooltipId","toolTipEl","info","window","setTimeout","_hide","_handleFocus","_handleKeyDown","key","_handleMouseOver","_handleMouseOut","undefined","relatedTarget","contains","_handleBlur","initializer","tts","querySelectorAll","i","length","addEventListener","bind","this"],"mappings":";;;;;;;AA0BAA,uCAAO,CAAC,cAAe,aAAa,SAASC,OAAQC,cAOxCC,aAAaC,MAC2B,YAAzCA,EAAEC,OAAOC,aAAa,mBAClBC,UAAYH,EAAEC,OAAOG,QAAQ,8BAE7BD,UAAYH,EAAEC,WAMdI,UAJJC,UAAY,WAAaH,UAAUD,aAAa,MAGlC,QAFdG,UAAYE,SAASC,eAAeF,cAGhCD,UAAYE,SAASE,cAAc,QAC7BC,GAAKJ,UACfD,UAAUM,UAAUC,IAAI,WACxBP,UAAUM,UAAUC,IAAI,mBACxBP,UAAUQ,aAAa,OAAQ,WAC/BV,UAAUU,aAAa,mBAAoBR,UAAUK,IACrDL,UAAUS,UAAY,sFACiBX,UAAUD,aAAa,gBAAkB,SAChFG,UAAUU,MAAMC,QAAU,IAC1BX,UAAUQ,aAAa,cAAe,QACtCN,SAASU,KAAKC,YAAYb,YAE1BA,UAAUU,MAAMI,QAAU,YAG1BtB,OAAOM,UAAWE,UAAW,CAC7Be,UAAW,CACPC,UAAW,WAMlBhB,UAAUU,MAAMC,QAAU,IAC1BX,UAAUQ,aAAa,cAAe,kBAelCS,aAAatB,MAC2B,YAAzCA,EAAEC,OAAOC,aAAa,mBAClBqB,UAAY,WAAavB,EAAEC,OAAOG,QAAQ,yBAAyBF,aAAa,WAEhFqB,UAAY,WAAavB,EAAEC,OAAOS,OAEtCc,UAAYjB,SAASC,eAAee,WAEtB,OAAdC,UACA1B,IAAI2B,KAAK,6BAA8B,0BAEvCD,UAAUT,MAAMC,QAAU,IAC1BU,OAAOC,WAxBH,SAASH,kBACV,WACHA,UAAUT,MAAMI,QAAU,OAC1BK,UAAUX,aAAa,cAAe,SAqBpBe,CAAMJ,WAAY,eAQnCK,aAAa7B,GAClBD,aAAaC,YAOR8B,eAAe9B,GACN,WAAVA,EAAE+B,KACFT,aAAatB,YAQZgC,iBAAiBhC,GACtBD,aAAaC,YAORiC,gBAAgBjC,QAEGkC,IAApBlC,EAAEmC,eAAmD,OAApBnC,EAAEmC,eAA0BnC,EAAEmC,cAAcxB,UAAUyB,SAAS,YAIpGd,aAAatB,YAORqC,YAAYrC,GACjBsB,aAAatB,SAGV,CAIHsC,YAAa,WACTxC,IAAI2B,KAAK,qBAAsB,iCAE3Bc,IAAMhC,SAASiC,iBAAiB,iDAC3BC,EAAI,EAAGA,EAAIF,IAAIG,OAAQD,IAC5BF,IAAIE,GAAGE,iBAAiB,QAASd,aAAae,KAAKC,OACnDN,IAAIE,GAAGE,iBAAiB,QAASd,aAAae,KAAKC,OACnDN,IAAIE,GAAGE,iBAAiB,YAAaX,iBAAiBY,KAAKC,OAC3DN,IAAIE,GAAGE,iBAAiB,WAAYV,gBAAgBW,KAAKC,OACzDN,IAAIE,GAAGE,iBAAiB,OAAQN,YAAYO,KAAKC,OACjDN,IAAIE,GAAGE,iBAAiB,UAAWb,eAAec,KAAKC"}