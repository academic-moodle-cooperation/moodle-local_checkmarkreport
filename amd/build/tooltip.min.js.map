{"version":3,"sources":["../src/tooltip.js"],"names":["define","Popper","log","_showTooltip","e","target","getAttribute","triggerEl","closest","tooltipid","tooltipEl","document","getElementById","createElement","id","classList","add","setAttribute","innerHTML","style","opacity","body","appendChild","display","modifiers","placement","_hide","toolTipEl","_hideTooltip","tooltipId","info","window","setTimeout","_handleFocus","_handleKeyDown","key","_handleMouseOver","_handleMouseOut","relatedTarget","contains","_handleBlur","initializer","tts","querySelectorAll","i","length","addEventListener","bind"],"mappings":"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","sourcesContent":["// This file is part of local_checkmarkreport for Moodle - http://moodle.org/\n//\n// It is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// It is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Handles overlays/tooltips in report tables!\n *\n * @package   local_checkmarkreport\n * @author    Philipp Hager\n * @copyright 2014 Academic Moodle Cooperation {@link http://www.academic-moodle-cooperation.org}\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\n/**\n * @module local_checkmarkreport/tooltips\n */\ndefine(['core/popper', 'core/log'], function(Popper, log) {\n\n    /**\n     * Find the tooltip referred to by this element and show it.\n     *\n     * @param {Event} e\n     */\n    function _showTooltip(e) {\n        if (e.target.getAttribute('data-toggle') !== 'tooltip') {\n            var triggerEl = e.target.closest('[data-toggle=tooltip]');\n        } else {\n            var triggerEl = e.target;\n        }\n        var tooltipid = 'tooltip_' + triggerEl.getAttribute('id');\n        var tooltipEl = document.getElementById(tooltipid);\n\n        if (tooltipEl === null) {\n            var tooltipEl = document.createElement('div');\n            tooltipEl.id = tooltipid;\n            tooltipEl.classList.add('popover');\n            tooltipEl.classList.add('bs-popover-auto');\n            tooltipEl.setAttribute('role', 'tooltip');\n            triggerEl.setAttribute('aria-describedby', tooltipEl.id);\n            tooltipEl.innerHTML = '<div class=\"arrow\"></div><h3 class=\"popover-header\"></h3>' +\n                    '<div class=\"popover-body\">' + triggerEl.getAttribute('data-content') + '</div>';\n            tooltipEl.style.opacity = '0';\n            tooltipEl.setAttribute('aria-hidden', 'true');\n            document.body.appendChild(tooltipEl);\n        } else {\n            tooltipEl.style.display = 'block';\n        }\n\n        new Popper(triggerEl, tooltipEl, {\n            modifiers: {\n                placement: 'right'/*,\n                flip: {\n                    behavior: 'clockwise'\n                }*/\n            }\n        });\n         tooltipEl.style.opacity = '1';\n         tooltipEl.setAttribute('aria-hidden', 'false');\n    }\n\n    var _hide = function(toolTipEl) {\n        return function() {\n            toolTipEl.style.display = 'none';\n            toolTipEl.setAttribute('aria-hidden', 'true');\n        };\n    };\n\n    /**\n     * Find the tooltip referred to by this element and hide it.\n     *\n     * @param {Event} e\n     */\n    function _hideTooltip(e) {\n        if (e.target.getAttribute('data-toggle') !== 'tooltip') {\n            var tooltipId = 'tooltip_' + e.target.closest('[data-toggle=tooltip]').getAttribute('id');\n        } else {\n            var tooltipId = 'tooltip_' + e.target.id;\n        }\n        var toolTipEl = document.getElementById(tooltipId);\n\n        if (toolTipEl === null) {\n            log.info('Tooltip element not found!', 'local_checkmarkreport');\n        } else {\n            toolTipEl.style.opacity = '0';\n            window.setTimeout(_hide(toolTipEl), 200);\n        }\n    }\n\n    /**\n     * Listener for focus events.\n     * @param {FocusEvent} e\n     */\n    function _handleFocus(e) {\n        _showTooltip(e);\n    }\n\n    /**\n     * Listener for keydown events.\n     * @param {KeyboardEvent} e\n     */\n    function _handleKeyDown(e) {\n        if (e.key === 'Escape') {\n            _hideTooltip(e);\n        }\n    }\n\n    /**\n     * Listener for mouseover events.\n     * @param {MouseEvent} e\n     */\n    function _handleMouseOver(e) {\n        _showTooltip(e);\n    }\n\n    /**\n     * Listener for mouseout events.\n     * @param {MouseEvent} e\n     */\n    function _handleMouseOut(e) {\n        // The mouseout-event's relatedTarget is the element which has been entered!\n        if (e.relatedTarget !== undefined && e.relatedTarget !== null && e.relatedTarget.classList.contains('content')) {\n            return;\n        }\n\n        _hideTooltip(e);\n    }\n\n    /**\n     * Listener for blur events.\n     * @param {FocusEvent} e\n     */\n    function _handleBlur(e) {\n        _hideTooltip(e);\n    }\n\n    return {\n        /**\n         * Initialises the JavaScript for the checkmark report\n         */\n        initializer: function() {\n            log.info('Register tooltips!', 'local_checkmarkreport');\n\n            var tts = document.querySelectorAll('#checkmarkreporttable [data-toggle=\"tooltip\"]');\n            for (var i = 0; i < tts.length; i++) {\n                tts[i].addEventListener('focus', _handleFocus.bind(this));\n                tts[i].addEventListener('click', _handleFocus.bind(this));\n                tts[i].addEventListener('mouseover', _handleMouseOver.bind(this));\n                tts[i].addEventListener('mouseout', _handleMouseOut.bind(this));\n                tts[i].addEventListener('blur', _handleBlur.bind(this));\n                tts[i].addEventListener('keydown', _handleKeyDown.bind(this));\n            }\n        }\n    };\n});\n"],"file":"tooltip.min.js"}